# AI Work Log

## Next.js App Router Best Practices Audit & Refactor

Based on an audit of the `src/` directory against Next.js App Router best practices and project guidelines, the following deviations were found and will be refactored:

- [ ] **Finding 1 (Ignored):** `src/pages/` Directory - Presence of Pages Router artifacts. (User requested to ignore).
- [ ] **Finding 2:** `src/app/(app)/(admin)/admin/cms/page.tsx`
    - **Issue:** Data fetching (`getCMSStatusAction`) in `useEffect`. Server Action used for data fetching.
    - **Plan:** Convert page to async Server Component, move status fetching logic to a new `cms-service.ts`, fetch directly in Server Component, extract interactive parts (form, state) to a new Client Component (`cms-management-client.tsx`), pass initial status and `seedCMSAction` as props. Remove `getCMSStatusAction`.
- [ ] **Finding 3:** `src/server/actions/projects.ts`
    - **Issue:** Server Actions (`getTeamProjects`, `userHasProjectAccess`, `getProjectMembers`) used for data fetching.
    - **Plan:** Remove these fetching functions from the actions file. Components needing this data should be updated (in a separate task) to call `projectService` directly.
- [ ] **Finding 4:** `src/server/actions/visitor-location.ts`
    - **Issue:** Server Action (`getRecentVisitors`) used for data fetching (in-memory).
    - **Plan:** Remove the `getRecentVisitors` function. Components needing this data should be updated (in a separate task) to access it via appropriate means (e.g., service).
- [ ] **Finding 5:** `src/server/actions/teams.ts`
    - **Issue:** Server Actions (`getUserTeams`, `getTeamMembers`) used for data fetching.
    - **Plan:** Remove these fetching functions from the actions file. Components needing this data should be updated (in a separate task) to call `teamService` directly (potentially incorporating caching logic).

---
